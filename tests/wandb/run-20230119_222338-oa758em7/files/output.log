
0it [00:00, ?it/s]
[[[[176 209 233]
   [176 209 233]
   [176 209 233]
   ...
   [176 209 233]
   [176 209 233]
   [176 209 233]]
  [[254 254 255]
   [254 254 255]
   [254 254 255]
   ...
   [254 254 255]
   [254 254 255]
   [254 254 255]]
  [[255 251 250]
   [255 251 250]
   [255 251 250]
   ...
   [255 251 250]
   [255 251 250]
   [255 251 250]]
  ...
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]]
 [[[175 209 233]
   [175 209 233]
   [175 209 233]
   ...
   [175 209 233]
   [175 209 233]
   [175 209 233]]
  [[252 254 255]
   [252 254 255]
   [252 254 255]
   ...
   [252 254 255]
   [252 254 255]
   [252 254 255]]
  [[253 251 250]
   [253 251 250]
   [253 251 250]
   ...
   [253 251 250]
   [253 251 250]
   [253 251 250]]
  ...
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]]
 [[[175 209 233]
   [175 209 233]
   [175 209 233]
   ...
   [175 209 233]
   [175 209 233]
   [175 209 233]]
  [[252 254 255]
   [252 254 255]
   [252 254 255]
   ...
   [252 254 255]
   [252 254 255]
   [252 254 255]]
  [[253 251 250]
   [253 251 250]
   [253 251 250]
   ...
   [253 251 250]
   [253 251 250]
   [253 251 250]]
  ...
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]
  [[109 109 109]
   [109 109 109]
   [109 109 109]
   ...
   [109 109 109]
   [109 109 109]
   [109 109 109]]]
 ...
 [[[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  ...
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]]
 [[[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  ...
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]]
 [[[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  ...
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]]
  [[ 77 134 176]
   [ 77 134 176]
   [ 77 134 176]
   ...
   [ 77 134 176]
   [ 77 134 176]

0it [17:00, ?it/s]
Traceback (most recent call last):
  File "train_predict.py", line 260, in <module>
    app()
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 311, in __call__
    return get_command(self)(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/core.py", line 716, in main
    return _main(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/core.py", line 216, in _main
    rv = self.invoke(ctx)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 683, in wrapper
    return callback(**use_params)  # type: ignore
  File "train_predict.py", line 240, in main
    state, scalars = p_train_step(state, batch)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/api.py", line 2253, in cache_miss
    execute = pxla.xla_pmap_impl_lazy(fun_, *tracers, **params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/pxla.py", line 974, in xla_pmap_impl_lazy
    compiled_fun, fingerprint = parallel_callable(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/linear_util.py", line 303, in memoized_fun
    ans = call(fun, *args)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/pxla.py", line 1245, in parallel_callable
    pmap_computation = lower_parallel_callable(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/pxla.py", line 1414, in lower_parallel_callable
    jaxpr, consts, replicas, parts, shards = stage_parallel_callable(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/pxla.py", line 1321, in stage_parallel_callable
    jaxpr, out_sharded_avals, consts = pe.trace_to_jaxpr_final(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 2065, in trace_to_jaxpr_final
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 1998, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/linear_util.py", line 167, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "train_predict.py", line 218, in train_step
    (loss, (dist_sq, dist_abs)), grad = grad_fn(state.params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/api.py", line 1167, in value_and_grad_f
    ans, vjp_py, aux = _vjp(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/api.py", line 2659, in _vjp
    out_primal, out_vjp, aux = ad.vjp(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/ad.py", line 137, in vjp
    out_primals, pvals, jaxpr, consts, aux = linearize(traceable, *primals, has_aux=True)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/ad.py", line 124, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 767, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/linear_util.py", line 167, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "train_predict.py", line 211, in compute_loss
    dist = out - img[:,context//2:,:,:]
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 603, in __sub__
    def __sub__(self, other): return self.aval._sub(self, other)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py", line 4948, in deferring_binary_op
    return binary_op(*args)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/api.py", line 626, in cache_miss
    top_trace.process_call(primitive, fun_, tracers, params))
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/ad.py", line 339, in process_call
    result = call_primitive.bind(_update_annotation(f_jvp, f.in_type, which_nz),
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 2024, in bind
    outs = top_trace.process_call(self, fun_, tracers, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 265, in process_call
    out = primitive.bind(_update_annotation_known(f_, f.in_type, in_knowns),
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 2024, in bind
    outs = top_trace.process_call(self, fun_, tracers, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 1739, in process_call
    jaxpr, out_type, consts = trace_to_subjaxpr_dynamic2(f, self.main, debug_info=dbg)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 2027, in trace_to_subjaxpr_dynamic2
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/linear_util.py", line 167, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/numpy/ufuncs.py", line 83, in <lambda>
    fn = lambda x1, x2, /: lax_fn(*_promote_args(numpy_fn.__name__, x1, x2))
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/lax.py", line 457, in sub
    return sub_p.bind(x, y)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 329, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 332, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/ad.py", line 310, in process_primitive
    primal_out, tangent_out = jvp(primals_in, tangents_in, **params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/lax.py", line 2153, in _sub_jvp
    primal_out = sub(x, y)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/lax.py", line 457, in sub
    return sub_p.bind(x, y)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 329, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 332, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 1713, in process_primitive
    return self.default_process_primitive(primitive, tracers, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 1717, in default_process_primitive
    out_avals, effects = primitive.abstract_eval(*avals, **params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 365, in abstract_eval_
    return abstract_eval(*args, **kwargs), no_effects
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/utils.py", line 66, in standard_abstract_eval
    return core.ShapedArray(shape_rule(*avals, **kwargs),
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/lax.py", line 1565, in broadcasting_shape_rule
    raise TypeError(f'{name} got incompatible shapes for broadcasting: '
jax._src.traceback_util.UnfilteredStackTrace: TypeError: sub got incompatible shapes for broadcasting: (16, 384, 384, 3), (16, 376, 384, 3).
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "train_predict.py", line 260, in <module>
    app()
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 328, in __call__
    raise e
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 311, in __call__
    return get_command(self)(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/core.py", line 716, in main
    return _main(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/core.py", line 216, in _main
    rv = self.invoke(ctx)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 683, in wrapper
    return callback(**use_params)  # type: ignore
  File "train_predict.py", line 240, in main
    state, scalars = p_train_step(state, batch)
  File "train_predict.py", line 218, in train_step
    (loss, (dist_sq, dist_abs)), grad = grad_fn(state.params)
  File "train_predict.py", line 211, in compute_loss
    dist = out - img[:,context//2:,:,:]
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py", line 4948, in deferring_binary_op
    return binary_op(*args)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/numpy/ufuncs.py", line 83, in <lambda>
    fn = lambda x1, x2, /: lax_fn(*_promote_args(numpy_fn.__name__, x1, x2))
TypeError: sub got incompatible shapes for broadcasting: (16, 384, 384, 3), (16, 376, 384, 3).
Traceback (most recent call last):
  File "train_predict.py", line 260, in <module>
    app()
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 311, in __call__
    return get_command(self)(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/core.py", line 716, in main
    return _main(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/core.py", line 216, in _main
    rv = self.invoke(ctx)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 683, in wrapper
    return callback(**use_params)  # type: ignore
  File "train_predict.py", line 240, in main
    state, scalars = p_train_step(state, batch)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/api.py", line 2253, in cache_miss
    execute = pxla.xla_pmap_impl_lazy(fun_, *tracers, **params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/pxla.py", line 974, in xla_pmap_impl_lazy
    compiled_fun, fingerprint = parallel_callable(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/linear_util.py", line 303, in memoized_fun
    ans = call(fun, *args)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/pxla.py", line 1245, in parallel_callable
    pmap_computation = lower_parallel_callable(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/pxla.py", line 1414, in lower_parallel_callable
    jaxpr, consts, replicas, parts, shards = stage_parallel_callable(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/pxla.py", line 1321, in stage_parallel_callable
    jaxpr, out_sharded_avals, consts = pe.trace_to_jaxpr_final(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 2065, in trace_to_jaxpr_final
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 1998, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/linear_util.py", line 167, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "train_predict.py", line 218, in train_step
    (loss, (dist_sq, dist_abs)), grad = grad_fn(state.params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/api.py", line 1167, in value_and_grad_f
    ans, vjp_py, aux = _vjp(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/api.py", line 2659, in _vjp
    out_primal, out_vjp, aux = ad.vjp(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/ad.py", line 137, in vjp
    out_primals, pvals, jaxpr, consts, aux = linearize(traceable, *primals, has_aux=True)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/ad.py", line 124, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 767, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/linear_util.py", line 167, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "train_predict.py", line 211, in compute_loss
    dist = out - img[:,context//2:,:,:]
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 603, in __sub__
    def __sub__(self, other): return self.aval._sub(self, other)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py", line 4948, in deferring_binary_op
    return binary_op(*args)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/api.py", line 626, in cache_miss
    top_trace.process_call(primitive, fun_, tracers, params))
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/ad.py", line 339, in process_call
    result = call_primitive.bind(_update_annotation(f_jvp, f.in_type, which_nz),
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 2024, in bind
    outs = top_trace.process_call(self, fun_, tracers, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 265, in process_call
    out = primitive.bind(_update_annotation_known(f_, f.in_type, in_knowns),
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 2024, in bind
    outs = top_trace.process_call(self, fun_, tracers, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 1739, in process_call
    jaxpr, out_type, consts = trace_to_subjaxpr_dynamic2(f, self.main, debug_info=dbg)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 2027, in trace_to_subjaxpr_dynamic2
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/linear_util.py", line 167, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/numpy/ufuncs.py", line 83, in <lambda>
    fn = lambda x1, x2, /: lax_fn(*_promote_args(numpy_fn.__name__, x1, x2))
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/lax.py", line 457, in sub
    return sub_p.bind(x, y)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 329, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 332, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/ad.py", line 310, in process_primitive
    primal_out, tangent_out = jvp(primals_in, tangents_in, **params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/lax.py", line 2153, in _sub_jvp
    primal_out = sub(x, y)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/lax.py", line 457, in sub
    return sub_p.bind(x, y)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 329, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 332, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 1713, in process_primitive
    return self.default_process_primitive(primitive, tracers, params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/interpreters/partial_eval.py", line 1717, in default_process_primitive
    out_avals, effects = primitive.abstract_eval(*avals, **params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/core.py", line 365, in abstract_eval_
    return abstract_eval(*args, **kwargs), no_effects
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/utils.py", line 66, in standard_abstract_eval
    return core.ShapedArray(shape_rule(*avals, **kwargs),
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/lax/lax.py", line 1565, in broadcasting_shape_rule
    raise TypeError(f'{name} got incompatible shapes for broadcasting: '
jax._src.traceback_util.UnfilteredStackTrace: TypeError: sub got incompatible shapes for broadcasting: (16, 384, 384, 3), (16, 376, 384, 3).
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "train_predict.py", line 260, in <module>
    app()
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 328, in __call__
    raise e
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 311, in __call__
    return get_command(self)(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/core.py", line 716, in main
    return _main(
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/core.py", line 216, in _main
    rv = self.invoke(ctx)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/typer/main.py", line 683, in wrapper
    return callback(**use_params)  # type: ignore
  File "train_predict.py", line 240, in main
    state, scalars = p_train_step(state, batch)
  File "train_predict.py", line 218, in train_step
    (loss, (dist_sq, dist_abs)), grad = grad_fn(state.params)
  File "train_predict.py", line 211, in compute_loss
    dist = out - img[:,context//2:,:,:]
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/numpy/lax_numpy.py", line 4948, in deferring_binary_op
    return binary_op(*args)
  File "/home/ubuntu/.local/lib/python3.8/site-packages/jax/_src/numpy/ufuncs.py", line 83, in <lambda>
    fn = lambda x1, x2, /: lax_fn(*_promote_args(numpy_fn.__name__, x1, x2))
TypeError: sub got incompatible shapes for broadcasting: (16, 384, 384, 3), (16, 376, 384, 3).